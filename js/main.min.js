"use strict";"localhost"!==location.hostname&&"127.0.0.1"!==location.hostname&&"https:"!==location.protocol&&location.replace(`https:${location.href.substring(location.protocol.length)}`);const start=document.querySelector(".start"),stop=document.querySelector(".stop"),restart=document.querySelector(".restart"),video=document.querySelector(".video"),loading=document.querySelector(".loading"),instructions=document.querySelector(".instructions"),genderEl=document.querySelector("#gender"),genderProbEl=document.querySelector("#genderProbability"),ageEl=document.querySelector("#age"),expressionEl=document.querySelector("#expression"),expressionProbEl=document.querySelector("#expressionProbability");let startAnalysis=!1;restart.addEventListener("click",()=>window.location.reload()),Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri("./models"),faceapi.nets.faceLandmark68Net.loadFromUri("./models"),faceapi.nets.faceRecognitionNet.loadFromUri("./models"),faceapi.nets.faceExpressionNet.loadFromUri("./models"),faceapi.nets.ageGenderNet.loadFromUri("./models")]).then(()=>navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1})).then(e=>{video.srcObject=e}).catch(e=>{console.error(e),loading.innerText=`Error!  ${e}`}),video.addEventListener("playing",()=>{loading.classList.remove("active");const e=[];start.addEventListener("click",o=>{startAnalysis=!0,t.classList.add("active"),instructions.classList.add("active"),e.length=0}),stop.addEventListener("click",e=>{startAnalysis=!1});const t=faceapi.createCanvasFromMedia(video);t.classList.add("canvas"),video.parentNode.insertBefore(t,video.nextSibling);const o={width:+window.getComputedStyle(video).width.slice(0,-2),height:+window.getComputedStyle(video).height.slice(0,-2)};faceapi.matchDimensions(t,o),setInterval(async()=>{function n(t){e.unshift(t)>=31&&(e.length=30);const o=e.reduce((e,t)=>e+t)/e.length;return o}const r=await faceapi.detectAllFaces(video,new faceapi.TinyFaceDetectorOptions).withFaceLandmarks().withFaceExpressions().withAgeAndGender(),i=faceapi.resizeResults(r,o);if(t.getContext("2d").clearRect(0,0,t.width,t.height),startAnalysis&&i.length>0){const{gender:e,genderProbability:t,age:o,expressions:r}=i[0],a=n(o),s=Object.keys(r),c=s.sort((e,t)=>r[e]-r[t])[s.length-1];genderEl.innerText=e.toUpperCase(),genderProbEl.innerText=`${Math.round(100*t)}%`,ageEl.innerText=`${Math.round(a,1)} years old`,expressionEl.innerText=c.toUpperCase(),expressionProbEl.innerText=`${Math.round(100*r[c])}%`}},100)});
//# sourceMappingURL=main.min.js.map